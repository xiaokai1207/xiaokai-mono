# web3基础

## 区块链

### 区块链的主要目的是什么
构建人人互信的交易环境

### 区块链的基本结构
- 交易
- 区块
- 区块链

#### 交易：Transaction（Tx）
和智能合约进行的所有改变链上数据的交互行为，都可以被称为交易。
交易必须包含三部分信息：发送地址、接收地址、交易数据。

#### 区块：Block
由于交易比较频繁，区块链不会在每次交易的时候都修改链上的数据，通常的做法是在一个特定的时间段内把 N 笔交易打包到一个区块中，这个也被称为打包时间或出块时间。
区块中包含的信息有：区块头、区块体。
区块头：包含区块的元信息，比如区块高度、上一个区块的哈希值、时间戳、随机数、交易数量等。
区块体：包含区块中所有的交易。

#### 区块链：Blockchain
区块链会以特定的规则将所有的区块链接到一起，一旦区块被链接，就几乎无法被篡改，除非能控制整个网络中的大部分节点。

### 区块链的运行原理
区块链本质上是一个 p2p 软件，就像快播这款软件一样，点对点传播，不依赖中心。数据不存储在中心服务器上，而是存储在每个用户的设备上，通过用户与用户之间的数据传输实现去中心化。

难道每一个使用区块链的人，都要在自己的电脑上装一款区块链软件吗？当然不是，因为搭建一个区块链节点的成本并不低，而且区块链软件的运行需要消耗大量的资源，所以区块链的节点通常是由专门的机构来搭建和维护的，这些机构被称为矿工。

经济模型：挖矿，矿工机制就是通过给一些人奖励，让他们愿意在自己的电脑上长期运行区块链软件，这样就实现了区块链的自治。其实就是一种价值互换，一种经济模型。

### 区块链的交易流程

- 客户端签名并发起交易（必须包含发送地址、接收地址、交易信息、签名）。
- 节点校验并广播交易（对交易的签名进行验证，查看交易是否合法，验证通过后对其他节点广播）。
- 争夺记账权（广播完成后，每个节点都可以争夺记账权，工作量证明，Pow，Pow的过程是解决数学难题）。
- 胜出者广播结果（在解决数学难题的过程中，哪个节点最先得到正确答案，哪个节点就挖到矿了，这个节点进行全网广播，把正确答案发给其他节点）。
- 分配奖励，同步账本（其他节点会验证答案是否正确，当验证正确后，其他节点就会放弃继续挖矿，成功挖到矿的节点就会获得奖励，同时全网同步账本）。

## 比特币和以太坊

### 比特币

2008年被中本聪提出，世界上第一款加密数字货币，数字黄金。

比特币的机制：发行总量固定，总量 2100 万，挖矿奖励每4年减半，会持续到 2140 年彻底停产，这样保证了比特币的稀缺性和价值，所以叫数字黄金。

### 以太坊

2013 年被 V 神提出，让去中心化应用实现普及的开发平台，数字石油。

正是因为以太坊这个项目，才让区块链被大众所熟知。

以太坊首先让挖矿变得容易了，任何一台计算机只需要运行以太坊的全节点客户端，就可以进行挖矿，这样保证了以太坊的节点非常多，成千上万，永不宕机。

另一个重要的发明是，以太坊设计了智能合约，并发明了 solidity 语言，让区块链具有了可编程性，这是一个了不起的发明，直接推动了如今 web3 生态的蓬勃发展。

同时以太坊还有另一个含义，那就是加密数字货币，以太坊货币也是长期处于加密数字货币市值第二位置的数字货币，由于以太坊货币是以太坊平台交互过程中不断被消耗的必备资源，和石油非常像，所以被称为数字石油。

## 账户

在 web2 中，不同的平台有不同的账户体系，每当我们切换应用的时候，都会更换不同的账户信息，而且账户中的资产是不相通的，比如王者荣耀的点券不能用于英雄联盟，而且一旦王者荣耀倒闭了，里面的点券也会消失。

但在 web3 的世界里，所有的应用都是基于同一个账户体系，所有的资产都是相通的，而且资产不会消失，因为资产都存储在区块链上，只要区块链不崩，资产就永远不会消失。

### 账户的组成

账户由四个部分组成：地址、私钥、公钥、助记词。

- 私钥：等价于银行卡卡号 + 密码
- 公钥：私钥经过 secp256k1 算法计算得到
- 地址：等价于银行卡卡号，公钥经过 Keccak256、转 16 进制、截取后 40 位得到
- 助记词：私钥的另一种表现形式，私钥不方便记忆，所以通过算法生成 12 个英文助记单词，私钥和助记词同等重要，拥有私钥或拥有助记词，就等于拥有了这个账户。

## 钱包 Wallet

由于运行全节点客户端对普通人比较麻烦，所以大多数人运行区块链都不是在本地运行节点，而是使用钱包。你可以把钱包理解成一个连接到区块链的工具，它会帮我们连接到某一个节点，然后依托这个节点和区块链进行交互。

钱包本身是一个 DApp，它的形式可以是一个网页、App、桌面程序、浏览器插件或者硬件设备，目前的钱包主流是浏览器插件，比如 MetaMask。

## 智能合约

智能合约是一种计算机程序，它可以在区块链上运行，当满足一定条件时，智能合约会自动执行一些操作，比如转账、发币、投票、合约执行等。

智能合约的特性：

- 分布式：一旦合约完成部署，所有的以太坊节点都会包含这份合约。
- 确定性：满足合约条件时，任何人执行合约，结果都会保持一致。
- 自主性：只要满足条件，合约就会自动完成任务，这就具备了自动强制执行的特点，无需任何人或者机构来担保或监督。
- 不变性：智能合约一旦被部署，合约内容就无法被篡改，也就没办法抵赖。
- 多样化：可以使用各种方法创建合约，只要最终编译为以太坊虚拟机可以识别的二进制代码就行，目前最主流的方式是 solidity 语言。以太坊是图灵完备的区块链，可以实现多种复杂逻辑。
- 去信任化：交易的多方无需了解对方的背景，因为区块链技术可以保证数据的准确无误，只需要确认合约逻辑正常就可以交易。
- 透明性：智能合约的源代码对所有人公开透明

智能合约的这些特性，对传统产业带来了巨大影响，智能合约目前的应用非常广泛，比如金融服务和供应链管理等


